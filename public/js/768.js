"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[768],{3768:(t,s,e)=>{e.r(s),e.d(s,{default:()=>r});const a={data:function(){return{customerData:{},fileErrors:{isExcel:!0,invalidExcelStructure:!1},form:new Form({excel:null}),uploadProgress:0,sheetData:null,tableSheet:[],importForm:new Form({sheetName:"",customerId:this.$route.params.customerId})}},methods:{verifyCustomerId:function(){var t=this;axios.get("/admin/api/check-customer-info",{params:{customerId:this.$route.params.customerId}}).then((function(t){return t.data})).then((function(s){"ok"==s.status?t.customerData=s.customer:t.$router.push({name:"customer.list"})})).catch((function(s){console.error(s.response.data),t.$router.push({name:"customer.list"})}))},uploadExcel:function(t){var s=t.target.files[0];if(s){var e=s.name.split(".").pop();["xls","xlsx"].includes(e)?(this.form.excel=s,this.fileErrors.isExcel=!0,this.submitForm()):(this.fileErrors.isExcel=!1,$("#excelFile").val(""))}else this.excel=null},submitForm:function(){var t=this,s=this;this.form.post("/admin/api/upload-excel-sheet",{onUploadProgress:function(t){var e=100*t.loaded/t.total;s.uploadProgress=e.toFixed(2)}}).then((function(t){return t.data})).then((function(s){t.sheetData=s,t.tableSheet=t.sheetData.data[0].sheet1})).catch((function(t){console.error(t.response.data)}))},changeSheet:function(t,s){this.tableSheet=this.sheetData.data[s][t]},importSheet:function(){this.importForm.sheetName=this.sheetData.sheetName,this.importForm.post("/admin/api/import-from-sheet").then((function(t){return t.data})).then((function(t){"ok"==t.status?swal.fire("Success",t.msg,"success").then((function(){window.location.reload()})):swal.fire("Failed",t.msg,"error")})).catch((function(t){console.error(t.response.data)}))}},mounted:function(){this.verifyCustomerId()}};const r=(0,e(1900).Z)(a,(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"content-header"},[e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row mb-2"},[t._m(0),t._v(" "),e("div",{staticClass:"col-sm-6"},[e("ol",{staticClass:"breadcrumb float-sm-right"},[e("li",{staticClass:"breadcrumb-item"},[e("router-link",{attrs:{to:{name:"dashboard"}}},[t._v("Home")])],1),t._v(" "),e("li",{staticClass:"breadcrumb-item active"},[t._v("Import Machine")])])])])])])]),t._v(" "),e("div",{staticClass:"col-12"},[e("div",{staticClass:"card"},[t._m(1),t._v(" "),e("div",{staticClass:"card-body"},[e("form",{on:{submit:function(s){return s.preventDefault(),t.importSheet.apply(null,arguments)}}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6 form-group"},[e("label",{attrs:{for:""}},[t._v("Customer Name")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"text",placeholder:"Customer name",disabled:""},domProps:{value:t.customerData.name}})]),t._v(" "),e("div",{staticClass:"col-md-6 form-group"},[e("label",{attrs:{for:""}},[t._v("Contact number")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"text",placeholder:"Contact number",disabled:""},domProps:{value:t.customerData.phone}})]),t._v(" "),t.uploadProgress>0?e("div",{staticClass:"col-md-12 form-group mt-5"},[t.uploadProgress<100?e("label",{attrs:{for:""}},[t._v("Progress  "+t._s(t.uploadProgress)+"%")]):e("p",{staticClass:"text-success"},[e("i",{staticClass:"fas fa-check-circle"}),t._v(" Upload complete   100%")]),t._v(" "),t.uploadProgress<100?e("div",{staticClass:"progress"},[e("div",{staticClass:"progress-bar progress-bar-striped progress-bar-animated",style:{width:t.uploadProgress+"%"},attrs:{role:"progressbar","aria-valuenow":t.uploadProgress,"aria-valuemin":"0","aria-valuemax":"100"}})]):t._e()]):t._e(),t._v(" "),t.fileErrors.isExcel?t._e():e("div",{staticClass:"col-md-12 form-group"},[t._m(2)]),t._v(" "),e("div",{staticClass:"col-md-6 form-group"},[e("label",{attrs:{for:""}},[t._v("Upload Excel File")]),t._v(" "),e("input",{staticClass:"form-control-file",attrs:{type:"file",accept:".xls,.xlsx",id:"excelFile"},on:{change:t.uploadExcel}})])]),t._v(" "),t.sheetData?e("div",{staticClass:"row mt-2"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"btn-group btn-group-toggle",attrs:{"data-toggle":"buttons"}},t._l(t.sheetData.data,(function(s,a){return e("label",{key:a,staticClass:"btn btn-outline-primary",class:{active:0==a}},[e("input",{attrs:{type:"radio",name:"options",id:"option"+a+1,checked:""},on:{change:function(s){return t.changeSheet("sheet"+(a+1),a)}}}),t._v(" Sheet "+t._s(a+1)+"\r\n                                ")])})),0)]),t._v(" "),e("div",{staticClass:"col-md-12 mt-2"},[e("div",{staticClass:"sheet-table"},[t._m(3),t._v(" "),e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered"},[t._m(4),t._v(" "),t._l(t.tableSheet,(function(s,a){return e("tbody",{key:a},[0!=a?[""!=s[0]?e("tr",[e("td",[e("b",[t._v(t._s(a))])]),t._v(" "),e("td",[t._v(t._s(s[0]))]),t._v(" "),e("td",[t._v(t._s(s[1]))]),t._v(" "),e("td",[t._v(t._s(s[1]))]),t._v(" "),e("td",[t._v(t._s(s[2]))]),t._v(" "),e("td",[t._v(t._s(s[3]))])]):t._e()]:t._e()],2)}))],2)])])])]):t._e(),t._v(" "),t.sheetData?e("div",{staticClass:"row mt-2"},[e("div",{staticClass:"col-12"},[e("Button",{staticClass:"btn btn-success",attrs:{form:t.importForm,type:"submit"}},[t._v("Import Data")])],1)]):t._e()])])])])])}),[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"col-sm-6"},[e("h1",{staticClass:"m-0"},[t._v("Dashboard")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"card-header"},[e("h4",[e("i",{staticClass:"fas fa-plus"}),t._v(" Import Excel Sheet")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"alert alert-warning alert-dismissible fade show",attrs:{role:"alert"}},[e("strong",[t._v("Invalid File !")]),t._v(" You should upload a xls or xlsx file.\r\n                                "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"alert","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("h5",{staticClass:"mt-2"},[e("b",[t._v("Sheet1")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("thead",[e("tr",[e("th",[t._v("#")]),t._v(" "),e("th",[t._v("Label number")]),t._v(" "),e("th",[t._v("Model")]),t._v(" "),e("th",[t._v("Name")]),t._v(" "),e("th",[t._v("Manufacturer")]),t._v(" "),e("th",[t._v("Bottom Serial")])])])}],!1,null,null,null).exports}}]);